import { useEffect, useState } from "react"
import { getStatusOptions } from "../services/statusService"
import { updateLead } from "../services/leadService"
import { getInactiveLeads } from "../services/leadService"
import { deleteLead } from "../services/leadService"
import TotalTime from "./TotalTime"

const InactiveLead = ({ inactiveLead, setInactiveLeads, currentAgentId }) => {

    const [statusOptions, setStatusOptions] = useState([])

    const handleChange = async (event) => {
        const statusId = parseInt(event.target.value)

        updateLead(inactiveLead.id, { ...inactiveLead, status: statusId })
       
        const inactiveLeadArray = await getInactiveLeads(currentAgentId)
        setInactiveLeads(inactiveLeadArray)
    }

    const handleClick = async () => {

        await deleteLead(inactiveLead.id)
        const inactiveLeadArray = await getInactiveLeads(currentAgentId)
        setInactiveLeads(inactiveLeadArray)
    }

    useEffect(() => {
        getStatusOptions().then(setStatusOptions)
    }, [setStatusOptions])

    return (
        <tr>
            <td data-label="Full Name">{inactiveLead.fullName}</td>
            <td data-label="Total Time">
                <TotalTime 
                    leadId={inactiveLead.id}
                />
            </td> 
            <td data-label="Status">
                <fieldset className="status-input">
                    <label className="sr-only" htmlFor="status">Status</label>
                    <select
                        name="status"
                        id="status"
                        value={inactiveLead.status}
                        onChange={handleChange}
                    >
                        {statusOptions.map(statusOption => (
                            <option key={statusOption.id} value={statusOption.id}>
                                {statusOption.type}
                            </option>
                        ))}
                    </select>
                </fieldset>
            </td >
            <td data-label="Delete">
                <button className="delete"
                    onClick={handleClick}
                ><svg width="30" height="27" viewBox="0 0 1524 1400" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1467.73 1316.27V1317.22L1465.97 1317.23C1466.14 1316.93 1466.14 1316.56 1465.97 1316.27H1467.73ZM472.533 1316.27V1317.71C472.356 1317.36 472.356 1316.94 472.533 1316.59V1316.27ZM1465.97 610.667L1467.09 611.786V610.667H1465.97ZM644.853 1316.27C645.025 1316.56 645.025 1316.93 644.853 1317.23H1294.61V1316.27L644.853 1316.27ZM510.133 1278.67V1279.63H1430.13V1278.67H510.133ZM510.133 1278.67V1270.67C510.133 1272.75 510.133 1275.63 509.972 1278.67H510.133ZM773.653 726.028H713.971C689.001 726.028 665.059 735.934 647.387 753.575C629.72 771.215 619.772 795.143 619.731 820.111V1172.11C619.731 1182.1 627.824 1190.19 637.809 1190.19C647.794 1190.19 655.892 1182.1 655.892 1172.11V820.111C655.934 804.736 662.069 790.001 672.96 779.141C683.845 768.287 698.596 762.188 713.971 762.188H773.809C783.794 762.188 791.892 754.094 791.892 744.109C791.892 734.125 783.793 726.027 773.809 726.027L773.653 726.028ZM884.216 1171.47L884.211 1171.47C884.211 1181.46 892.305 1189.55 902.29 1189.55C912.279 1189.55 920.372 1181.46 920.372 1171.47V819.473C920.414 804.099 926.549 789.364 937.44 778.504C948.326 767.65 963.076 761.551 978.451 761.551H1038.29C1048.28 761.551 1056.37 753.457 1056.37 743.472C1056.37 733.487 1048.28 725.389 1038.29 725.389H978.451C953.487 725.389 929.539 735.301 911.872 752.936C894.2 770.576 884.252 794.504 884.211 819.472L884.216 1171.47ZM1175.74 1189.55L1175.73 1189.55C1185.74 1189.55 1193.88 1181.48 1193.97 1171.47V819.473C1194.01 804.124 1200.13 789.416 1210.98 778.561C1221.84 767.712 1236.54 761.592 1251.89 761.551H1311.73C1321.72 761.551 1329.81 753.457 1329.81 743.472C1329.81 733.487 1321.72 725.389 1311.73 725.389H1251.73C1226.78 725.436 1202.86 735.353 1185.2 752.983C1167.54 770.613 1157.58 794.519 1157.49 819.472V1171.47C1157.58 1181.48 1165.72 1189.55 1175.73 1189.55L1175.74 1189.55ZM841.97 647.948H876.21H908.21H841.97ZM1523.25 714.188V954.188H1467.73V1315.79H1465.97C1466.14 1316.08 1466.14 1316.45 1465.97 1316.75C1464.68 1346.6 1448.02 1373.64 1421.93 1388.2C1395.85 1402.76 1364.08 1402.76 1338.01 1388.2C1311.92 1373.64 1295.26 1346.6 1293.97 1316.75V1315.79L644.85 1315.79C645.022 1316.09 645.022 1316.45 644.85 1316.75C643.564 1346.6 626.897 1373.64 600.814 1388.2C574.735 1402.76 542.965 1402.76 516.887 1388.2C490.805 1373.64 474.138 1346.6 472.851 1316.75H473.971L472.211 1315.63L224.531 1143.95C217.598 1146.68 210.213 1148.04 202.771 1147.95C186.26 1147.91 170.437 1141.34 158.749 1129.69C147.057 1118.03 140.452 1102.22 140.369 1085.71V878.833L0.689392 790.354V526.034H140.369V276.754H467.569C494.835 224.014 541.449 183.88 597.652 164.754L626.292 156.275L621.49 185.713C615.334 216.349 619.381 248.155 633.011 276.27H714.771V272.749V272.754C711.141 250.328 709.588 227.618 710.13 204.91C716.687 99.7903 786.927 37.2303 931.25 7.95031L968.053 0.752441L952.053 34.5124C886.615 171.632 915.413 191.632 958.454 221.712H958.449C981.673 236.024 1001.89 254.718 1017.97 276.754H1059.73C1073.81 236.592 1102.77 197.712 1178.77 185.232L1208.37 180.274L1199.73 209.077C1177.97 279.951 1217.97 318.994 1264.05 363.477C1300.53 398.357 1337.97 434.674 1341.33 487.955L1465.97 610.674L1467.09 611.794V694.195H1502.45C1507.92 694.065 1513.21 696.148 1517.13 699.976C1521.04 703.799 1523.25 709.044 1523.25 714.518L1523.25 714.188ZM62.7171 565.868L140.316 613.868L159.034 625.707L177.914 637.389L306.717 717.389H373.597L177.917 593.545L159.037 581.706L140.318 570.024L133.917 565.863L62.7171 565.868ZM158.717 843.628L177.914 855.946L291.196 927.784V753.704L177.914 683.783L159.034 672.101L140.316 660.419L40.4771 598.507V768.427L140.316 832.427L158.717 843.628ZM472.157 637.228L177.917 340.908V546.348L436.317 709.068V973.548L292.317 974.506L178.718 902.824V1065.06L472.478 1270.18L472.157 637.228ZM637.117 609.707C580.638 567.947 533.92 467.467 585.92 410.987C596.8 441.705 651.04 485.388 680.321 507.789V507.784C710.29 530.929 746.654 544.279 784.482 546.024C785.92 477.545 864.482 431.144 854.242 314.344C854.242 311.146 853.925 307.943 853.284 304.745L853.279 304.75C858.258 307.667 863.071 310.875 867.68 314.349C945.602 370.349 899.68 434.989 942.243 475.149C993.44 523.149 1038.24 555.149 1082.24 528.431C1126.24 501.712 1105.12 430.832 1150.72 415.311C1182.72 495.311 1213.76 484.909 1209.44 546.029V546.024C1209.44 571.207 1197.59 594.92 1177.44 610.024H1185.6C1239.2 606.665 1297.6 553.221 1303.68 503.623V503.628C1303.84 501.071 1303.84 498.503 1303.68 495.946C1303.73 488.878 1302.86 481.836 1301.12 474.987C1292.96 442.987 1267.04 418.184 1237.12 389.867C1222.4 375.466 1206.88 360.586 1193.12 344.268V344.263C1164.75 312.597 1151.14 270.383 1155.68 228.107C1130.52 234.961 1109.64 252.509 1098.56 276.107C1095.88 282.513 1093.79 289.154 1092.32 295.946C1090.56 301.868 1088.96 308.264 1087.52 314.826C1086.08 321.388 1085.12 326.508 1084 332.425C1081.44 352.649 1075.32 372.258 1065.92 390.346C1061.49 397.856 1054.01 403.059 1045.42 404.597C1036.84 406.133 1028.02 403.852 1021.26 398.347C1014.5 392.841 1010.47 384.659 1010.24 375.945C1009.19 354.591 1004.25 333.612 995.68 314.024C992.539 307.618 988.732 301.555 984.321 295.945C979.737 289.101 974.367 282.82 968.321 277.227C958.633 268.523 948.31 260.555 937.44 253.383C882.878 215.304 850.56 179.784 902.878 54.0225C801.118 81.5439 752.958 129.861 747.838 208.263H747.843C747.442 228.617 748.833 248.96 751.999 269.065C751.999 271.784 751.999 274.503 753.119 277.227C753.119 283.149 754.557 289.388 755.197 295.945C755.838 302.508 756.479 308.263 756.796 314.825H756.801C757.921 329.309 757.921 343.861 756.801 358.347C755.958 368.826 751.296 378.628 743.702 385.893C736.109 393.159 726.109 397.383 715.604 397.763C705.099 398.138 694.817 394.649 686.724 387.945L679.041 381.227C653.817 362.253 631.312 339.915 612.161 314.825C608.115 308.726 604.375 302.424 600.964 295.945C597.74 289.914 594.958 283.659 592.641 277.227C585.203 256.732 581.672 235.024 582.24 213.227C554.046 228.273 530.193 250.309 512.964 277.227C508.411 283.128 504.344 289.388 500.802 295.945C497.318 302.013 494.266 308.32 491.682 314.825C470.068 365.508 463.89 421.445 473.922 475.625C486.402 542.985 573.282 612.905 637.442 609.705L637.117 609.707ZM1430.08 647.947H510.077V1270.35V1278.35V1279.31H1430.08V647.947ZM472.797 1316.11C472.625 1316.46 472.625 1316.87 472.797 1317.23H473.917L472.797 1316.11Z" fill="currentColor" />
                    </svg>

                </button>
            </td>
        </tr >
    )
}


export default InactiveLead


